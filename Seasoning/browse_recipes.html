{% extends "base.html" %}
{% load addcss %}

{% block title %}Recepten{% endblock %}

{% block extra_link %}
<!-- Custom Fonts -->
{% if LOCAL_TEST %}
<link href='{{ STATIC_URL }}dev/LobsterTwo.css' rel='stylesheet' type='text/css'>
{% else %}
<link href='https://fonts.googleapis.com/css?family=Lobster+Two' rel='stylesheet' type='text/css'>
{% endif %}
{% endblock %}

{% block extra_script %}
<script>
var ingredient_names_url = '{% url 'ajax_ingredient_name_list' %}'
</script>
<script src="{{ STATIC_URL }}js/forms.js"></script>
<script src="{{ STATIC_URL }}js/jquery-ui.min.js"></script>
<script src="{{ STATIC_URL }}js/browse_recipes.js"></script>
<script src="{{ STATIC_URL }}js/ajax_content_loader.js"></script>
<link href="https://gitcdn.github.io/bootstrap-toggle/2.2.0/css/bootstrap-toggle.min.css" rel="stylesheet">
<script src="https://gitcdn.github.io/bootstrap-toggle/2.2.0/js/bootstrap-toggle.min.js"></script>
<script>
$(function() {
	$("#browse-recipe-summaries-wrapper").ajax_load({
		ajax_url: '{% url "ajax_browse_recipes" %}',
		form: $("#{{ search_form_id }}"),
		page_field_to_update: $("#id_page"),
		loader_element: $("#recipes-ajax-loader"),
		no_more_data_element_to_show: $("#recipes-ajax-done"),
		no_results_element_to_show: $("#recipes-ajax-noresults"),
		continue_ask_after_reloads: 5,
		continue_ask_element_to_show: $("#recipes-ajax-more"),
	});
	$("#{{ search_form.search_string.auto_id }}").focus();
});
</script>
<style>
body {
	background-color: #f4f4f4;
}
.ui-autocomplete {
	z-index: 1001;
	border-color: #629b31;
	border-width: 2px;
	border-top: none;
}
.ui-corner-all {
	border-radius: 0;
}
.ui-menu .ui-menu-item a {
	padding: 10px;
}
.ui-autocomplete .ui-state-focus {
	background: none;
	border-color: rgba(98, 155, 49, .3);
	background-color: rgba(98, 155, 49, .3);
}

.incl-ing-template,
.excl-ing-template {
	display: none;
}

.incl-ing label,
.excl-ing label,
.incl-ing input,
.excl-ing input {
	display: none;
}

.ing-name {
	font-size: 16px;
	background-color: rgba(98, 155, 49, .1);
	border: 1px solid rgba(98, 155, 49, .4);
	margin-bottom: 10px;
	padding: 10px;
	color: #888;
}
.ing-name a {
	color: #888;
}

.ing-input-wrapper .ajax-loader {
	position: absolute;
	right: 0;
	top: 0;
	height: calc(100% - 20px);
	margin: 10px 5px;
	padding: 0;
	display: none;
}
</style>
{% endblock %}

{% block recipes-active %}active{% endblock %}

{% block before-content %}
<form id="{{ search_form_id }}" class="recipe-search-form keywords" action="" method="post">
	{% csrf_token %}
	
	{{ search_form.page }}
	
	{{ search_form.advanced_search|addcss:"style,display:none;" }}
	
	{{ include_ingredients_formset.management_form }}
	{{ exclude_ingredients_formset.management_form }}
	            
	
	<div id="base-recipe-search-container">
		<div id="base-recipe-search" class="navbar-form">
			{{ search_form.search_string|addcss:"class,form-control" }}
	    </div>
	</div>
	
	<div class="cd-tab-filter-wrapper">
		
		<a href="#" class="cd-filter-trigger">Geavanceerd Zoeken</a>
		
		<div id="sort-field-wrapper" class="cd-tab-filter">
			<ul class="cd-filters">
				{% for sort_field, sort_field_display in search_form.fields.sort_field.choices %}
					{% if search_form.sort_field.value == sort_field %}
					<li class="placeholder">
						<a href="#" data-type="all">{{ sort_field_display|safe }}</a>
					</li>
					{% endif %}
				{% endfor %}
				
				{% for sort_field, sort_field_display in search_form.fields.sort_field.choices %}
					<li class="filter">
						<a {% if search_form.sort_fields.value == sort_field %}class="selected" {% endif %}
						   href="#" data-type="all"
						   data-value={{ sort_field }}>{{ sort_field_display|safe }}</a>
					</li>
				{% endfor %}
			</ul> <!-- cd-filters -->
			{{ search_form.sort_field }}
		</div> <!-- cd-tab-filter -->
	</div> <!-- cd-tab-filter-wrapper -->

	<section id="browse-recipe-summaries-wrapper" class="cd-gallery">
		
	</section>
	
	<div id="recipes-ajax-loader">
		{% include "includes/ajax-loader.html" with load_text="Recepten worden geladen..." %}
	</div>
		
	<div id="recipes-ajax-more" style="clear: both; text-align: center; display: none; height: 100px;">
		<a class="btn btn-default" href="#">Meer recepten tonen</a>
	</div>
				
	<div id="recipes-ajax-done" style="clear: both; text-align: center; display: none; height: 100px;">
		<a class="btn btn-default" href="#{{ search_form_id }}">Terug naar boven</a>
	</div>
			
	<div id="recipes-ajax-noresults" style="clear: both; text-align: center; display: none; height: 60px; font-size: 20px;">
		Je zoekopdracht heeft geen resultaten opgeleverd...
	</div>
	
	<div class="cd-filter">
		<div class="cd-filter-block">
			<h4>Speciale Eigenschappen</h4>
			<ul id="special-inputs" class="cd-filter-content cd-filters list">
				<li>
					<input id="{{ search_form.inseason.auto_id }}" name="{{ search_form.inseason.name }}" 
						   class="filter" type="checkbox" data-filter=".spec-check-1">
					<label class="checkbox-label" for="{{ search_form.inseason.auto_id }}">Enkel In Seizoen</label>
				</li>
				<li>
					<input id="{{ search_form.no_endangered.auto_id }}" name="{{ search_form.no_endangered.name }}" 
						   class="filter" type="checkbox" data-filter=".spec-check-2">
					<label class="checkbox-label" for="{{ search_form.no_endangered.auto_id }}">Geen Overbeviste ingredienten</label>
				</li>
			</ul>
		</div>
		
		<div class="cd-filter-block">
			<h4>Voedingswijze</h4>
			<ul id="special-inputs" class="cd-filter-content cd-filters list">
				{% for veganism_choice in search_form.veganism %}
				<li>
					<input id="{{ search_form.veganism.auto_id }}_{{ forloop.counter0 }}" type="checkbox" value="{{ veganism_choice.choice_value }}"
						   name="{{ veganism_choice.name }}" class="filter" checked="checked" />
					<label class="checkbox-label" for="{{ search_form.veganism.auto_id }}_{{ forloop.counter0 }}">{{ veganism_choice.choice_label }}</label>
				</li>
				{% endfor %}
			</ul>
		</div>	
	
		<div id="incl-ingredients" class="cd-filter-block">
			<h4>Gewenste Ingrediënten</h4>
			<div class="cd-filter-content">
				
				<div id="incl-ing-operator">
					<input id="{{ search_form.include_ingredients_AND_operator.auto_id }}" name="{{ search_form.include_ingredients_AND_operator.name }}"
				       data-toggle="toggle" data-off="Minstens één" data-on="Allemaal" type="checkbox">
				</div>
				<div class="incl-ing incl-ing-template">
					{{ include_ingredients_formset.empty_form }}
					<div class="ing-name">
						<span class="text"></span>
						<a href="#" class="pull-right" onclick="$(this).parent().parent().fadeOut(200, function(){$(this).remove();update_recipe_page();});return false;"><span class="glyphicon glyphicon-remove"></span></a>
					</div>
				</div>
				<div class="ing-input-wrapper" style="position: relative;">
					<input id="incl-ingredients-input" type="search" placeholder="Voer Ingrediënten in...">
					<img src="{{ STATIC_URL }}img/decoration/ajax-loader.png" class="ajax-loader" />
				</div>
			</div>
		</div>
		
		<div id="excl-ingredients" class="cd-filter-block">
			<h4>Ongewenste Ingrediënten</h4>
			<div class="cd-filter-content">
				<div class="excl-ing excl-ing-template">
					{{ exclude_ingredients_formset.empty_form }}
					<div class="ing-name">
						<span class="text"></span>
						<a href="#" class="pull-right" onclick="$(this).parent().parent().fadeOut(200, function(){$(this).remove();update_recipe_page();});return false;"><span class="glyphicon glyphicon-remove"></span></a>
					</div>
				</div>
				<div class="ing-input-wrapper" style="position: relative;">
					<input id="excl-ingredients-input" type="search" placeholder="Voer Ingrediënten in...">
					<img src="{{ STATIC_URL }}img/decoration/ajax-loader.png" class="ajax-loader" />
				</div>
			</div>
		</div>
		
		<div class="cd-filter-block boolean-inputs">
			<h4>Type Maaltijd</h4>
			<ul class="cd-filter-content cd-filters list">
				{% for value,option in search_form.fields.course.choices %}
				<li>
					<input id="id_course_{{ value }}" name="course" value="{{ value }}"
						   class="filter" type="checkbox" data-filter=".check1">
					<label class="checkbox-label" for="id_course_{{ value }}">{{ option }}</label>
				</li>
				{% endfor %}
			</ul>
		</div>
		
		<div class="cd-filter-block boolean-inputs">
			<h4>Keuken</h4>
			<ul class="cd-filter-content cd-filters list">
				{% for value,option in search_form.fields.cuisine.choices %}
				<li>
					<input id="id_cuisine_{{ value }}" name="cuisine" value="{{ value }}"
					       class="filter" type="checkbox" data-filter=".check1">
					<label class="checkbox-label" for="id_cuisine_{{ value }}">{{ option }}</label>
				</li>
				{% endfor %}
			</ul>
		</div>
		
		<a class="cd-close" href="#0">Geavanceerd Zoeken Verbergen</a>
	</div>
	<!-- 
	<div id="advanced-search-options">
		<p>
			Deze functie is in ontwikkeling en bijgevolg momenteel nog niet beschikbaar. Onze excuses!
		</p>
		<a onclick='$("#advanced-search-options").slideToggle(500);return false;'>Geavanceerd Zoeken verbergen</a>
	</div>
	
	<div id="results-container">
		<div id="browse-recipe-summaries-wrapper" class="summaries-wrapper">
		</div>
	</div>
		    -->
	<br class="clear" />
</form>

{% endblock %}
