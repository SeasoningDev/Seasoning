{% extends "admin/admin_base.html" %}
{% load addcss %}

{% block content %}
<div class="row">
	<div class="col-lg-12">
		<h1 class="page-header">Scraped Recipe nakijken en toevoegen</h1>
	</div>
</div>

<form action="" method="POST" class="form-horizontal" style="padding-bottom: 100px;">
	{% csrf_token %}
  <fieldset>
    <legend>{{ recipe.name }}</legend>
    
    <div class="form-group">
      <label class="col-lg-2 control-label" style="white-space:nowrap">Original Recipe</label>
      <div class="col-lg-10">
      	<div class="form-control">
        	<a href="{{ recipe.external_url }}">{{ recipe.external_url }}</a>
        </div>
      </div>
    </div>
    <br>
    <div class="form-group{% if recipe.name.errors %} has-error{% endif %}">
      <label for="inputName" class="col-lg-2 control-label" style="white-space:nowrap">Name</label>
      <div class="col-lg-10">
        {{ recipe_form.name|addcss:"class,form-control,placeholder,Recipe Name" }}
      </div>
    </div>
    <br>
    <div class="form-group">
      <label class="col-lg-2 control-label" style="white-space:nowrap">Scraped Course</label>
      <div class="col-lg-10">
      	<div class="form-control">
        	<span class="text-warning">{{ recipe.course_proposal }}</span>
        </div>
      </div>
    </div>
    <div class="form-group">
      <label for="inputCourse" class="col-lg-2 control-label" style="white-space:nowrap">Course</label>
      <div class="col-lg-10">
        {{ recipe_form.course|addcss:"class,form-control" }}
      </div>
    </div>
    <div class="form-group">
      <label class="col-lg-2 control-label" style="white-space:nowrap">Scraped Cuisine</label>
      <div class="col-lg-10">
      	<div class="form-control">
        	<span class="text-warning">{{ recipe.cuisine_proposal }}</span>
        </div>
      </div>
    </div>
    <div class="form-group">
      <label for="inputCuisine" class="col-lg-2 control-label" style="white-space:nowrap">Cuisine</label>
      <div class="col-lg-10">
        {{ recipe_form.cuisine|addcss:"class,form-control" }}
      </div>
    </div>
    <br>
    <div class="form-group">
      <label for="inputPortions" class="col-lg-2 control-label" style="white-space:nowrap">Portions</label>
      <div class="col-lg-10">
        {{ recipe_form.portions|addcss:"class,form-control" }}
      </div>
    </div>
    <div class="form-group">
      <label for="inputPortions" class="col-lg-2 control-label">Image</label>
      <div class="col-lg-10">
        <img style="width: 400px;" src="{{ recipe.image_url }}">
      </div>
    </div>
    <br>
    <div class="form-group">
      <label for="inputPortions" class="col-lg-2 control-label">Ingredienten</label>
      <div class="col-lg-10">
      	{{ uses_ingredients_formset.management_form }}
      	
    	{% for form in uses_ingredients_formset %}
    	{{ form.id }}
    	<div class="panel panel-{% if form.errors %}danger{% elif form.instance.ingredient != None and not form.instance.ingredient.accepted %}warning{% elif form.instance.unit == None or form.instance.amount == '' %}warning{% else %}default{% endif %}">
    		<div class="panel-heading">
    			Scraped: <b style="margin-left: 10px;">{{ form.instance.amount_proposal|default_if_none:"" }} {{ form.instance.unit_proposal|default_if_none:"" }} {{ form.instance.ingredient_proposal }}</b>
    			{% if form.instance.ingredient != None and  not form.instance.ingredient.accepted %}
    			<span class="pull-right">
    				Ingredient is not yet accepted <a href="{% url 'admin:ingredients_ingredient_change' form.instance.ingredient.id %}" target="_blank">Click here to edit</a>
    			</span>
    			{% elif form.instance.unit == None %}
    			<span class="pull-right">
    				No Unit given
    			</span>
    			{% elif form.instance.amount == '' %}
    			<span class="pull-right">
    				No Amount given
    			</span>
    			{% endif %}
    		</div>
    		<div class="panel-body">
    			{% for error in form.non_field_errors %}
    			<p class="text-danger">
    				{{ error }}
    			</p>
    			{% endfor %}
    			<table class="form-inline">
    				<tr valign="top">
	    		    	<td style="padding-right: 20px;">
	    		    		{{ form.amount|addcss:"class,form-control" }}
	    		    	</td>
	    		    	<td style="padding-right: 20px;">
				      		{{ form.unit|addcss:"class,form-control" }}
				      	</td>
				      	<td>
				      		{{ form.ingredient|addcss:"class,form-control" }}
				  			{% if form.instance.ingredient %}
				      		<br>
				      		<a href="{% url 'admin:ingredients_ingredient_change' form.instance.ingredient.id %}" target="_blank">Open dit ingredient in een nieuwe tab</a>
				      		{% endif %}
				      	</td>
			      	</tr>
			  </table>
    		</div>
    	</div>
    	{% endfor %}
      </div>
    </div>
    <div class="form-group">
    	<label for="inputPassword" class="col-lg-2 control-label"></label>
      <div class="col-lg-10">
        <div class="checkbox">
          <label>
            {{ recipe_form.ignore }} Dit recept niet meer scrapen
          </label>
        </div>
      </div>
    </div>
    <div class="form-group">
      <div class="col-lg-5 col-lg-offset-2">
        <button type="submit" class="btn btn-primary btn-block">Submit</button>
      </div>
      <div class="col-lg-5">
        <a href="{% url 'admin_proofread_scraped_recipes' %}" class="btn btn-primary btn-block">Back</a>
      </div>
    </div>
  </fieldset>
</form>

<style>
#make-objects-btns {
	position: fixed;
	bottom: 0;
	right: calc(50% - 260px);
}
</style>
<div id="make-objects-btns" class="row">
 	<div class="btn-group" role="group" aria-label="Default button group">
        <a href="{% url 'admin:recipes_cuisine_add' %}" target="_blank" type="button" class="btn btn-info">Add New Cuisine</a>
        <a href="{% url 'admin:ingredients_unit_add' %}" target="_blank" type="button" class="btn btn-info">Add New Unit</a>
        <a href="{% url 'admin:ingredients_ingredient_add' %}" target="_blank" type="button" class="btn btn-info">Add New Ingredient</a>
        <a href="{% url 'admin:ingredients_canuseunit_add' %}" target="_blank" type="button" class="btn btn-info">Add New CanUseUnit</a>
        
    </div>
</div>
{% endblock %}