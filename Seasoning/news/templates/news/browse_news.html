{% extends "base.html" %}

{% block title %}Nieuws{% endblock %}

{% block extra_script %}
<script>
function loadMoreNews() {
	var next_page = parseInt($("#news-pages-loaded").val()) + 1;
	$("#news-pages-loaded").val(next_page);
	
	$.ajax({
		type : "GET",
		url : window.location + "?page=" + next_page,
	    success : function(data) {
	    	// The url returns full html
			$(data).insertAfter($(".news-item-wrapper").last());
			$(window).bind('scroll', bindScroll);
	    },
        error: function() {
        	$("#loading-news").text("Er werd geen ouder nieuws gevonden...");
        }
	});
}

function bindScroll() {
	var x1 = $(window).scrollTop();
	var x2 = 2*$(window).height();
	
	var x3 = $("#news-list-wrapper").offset().top;
	var x4 = $("#news-list-wrapper").height();
	if ($(window).scrollTop() + 2*$(window).height() > $("#news-list-wrapper").offset().top + $("#news-list-wrapper").height()) {
		$(window).unbind('scroll', bindScroll);
		loadMoreNews();
	}
}
	
			


$(function() {
	if ($(".news-item-wrapper").length > 0) {
		$(window).scroll(bindScroll);
		bindScroll();
	}
});
</script>
{% endblock %}

{% block news-active %}active{% endblock %}

{% block content %}

<h1 id="news-title">Nieuws</h1>

<div id="twitter-feed-placeholder"></div>

<input id="news-pages-loaded" type="hidden" value="1" />
<div id="news-list-wrapper">
	{% include "includes/news_list.html" %}
    
    {% if news.object_list %}
    <div id="loading-news">
    	Ouder nieuws wordt geladen...
    	<div style="margin: 10px 320px 0 0">
    	{% include "includes/big-ajax-loader.html" %}
    	</div>
    	<br /><br />
    	<br class="left" />
    </div>
    {% else %}
    <div id="loading-news">
    	Er werd geen nieuws gevonden...
    	<br /><br />
    	<br class="left" />
    </div>
    {% endif %}
</div>

<div id="twitter-feed-wrapper">
	<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
	<a class="twitter-timeline"  href="https://twitter.com/Seasoningbe"  data-widget-id="394430582345576448">
		<div id="twitter-loading-text">Loading Tweets</div>
		{% include "includes/ajax-loader.html" %}
	</a>
	<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
</div>

{% endblock %}
